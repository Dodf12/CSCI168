<!DOCTYPE html>
<html>
  <body>
    <script src="https://cdn.jsdelivr.net/npm/three/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three/examples/js/controls/OrbitControls.js"></script>
    <script>

    window.onload = init;

    //glbal Variables
    let scene, camera, renderer;
    let cube;
    
    function init() {
    // renderer
    renderer = new THREE.WebGLRenderer();
    renderer.setSize(800, 600);
    renderer.shadowMap.enabled = true;
    
    document.body.appendChild(renderer.domElement);

        // Scene
    scene = new THREE.Scene();

    cube = new THREE.Mesh(
      new THREE.BoxGeometry(1, 1, 1),
        new THREE.MeshBasicMaterial({ color: 0x242124  }));
    scene = new THREE.Scene();
    //scene.add(cube);

  
    function addFloor(scene) {
      const geometry = new THREE.BoxGeometry(200, 10, 200);
      const textureLoader = new THREE.TextureLoader();
      const floorTexture = textureLoader.load('https://dl.polyhaven.org/file/ph-assets/Textures/jpg/4k/precast_stone_paving/precast_stone_paving_diff_4k.jpg');
      // Set texture wrapping and repetition
      floorTexture.wrapS = THREE.RepeatWrapping;
      floorTexture.wrapT = THREE.RepeatWrapping;
      floorTexture.repeat.set(4, 4); // Adjust the repetition for better tiling

      // Use MeshStandardMaterial for lighting interaction
      const material = new THREE.MeshStandardMaterial({
        map: floorTexture, // Apply the texture
      
      });

      const floor = new THREE.Mesh(geometry, material);
      floor.position.set(0, -10, 0);
      //floor.receiveShadow = true; 
      scene.add(floor);
    }
    addFloor(scene);

    function addWall(scene) {
      
    }

    //Here is the basketball
    function addSphere(scene){
      let g = new THREE.SphereGeometry(5, 32, 32);


      const textureLoader = new THREE.TextureLoader();
      const basketballTexture = textureLoader.load('https://images-ext-1.discordapp.net/external/x4NGWr1hj3IOxnbVk3kiuFeJaeIYRGxZ-FUy3DfL9gQ/https/static.turbosquid.com/Preview/2014/08/01__18_43_57/Basketball%2Btexture%2BBIG.jpgc6d13a7d-85d2-48e2-98d7-eadad3cf75daLarge.jpg?format=webp&width=900&height=450');
      basketballTexture.wrapS = THREE.RepeatWrapping;
      basketballTexture.wrapT = THREE.RepeatWrapping;

      let m = new THREE.MeshStandardMaterial({
        color: 0xdf7237,
        map: basketballTexture,
        metalness: 0.9,
        roughness: 0.7,
      });


      let basketball = new THREE.Mesh(g, m);
      basketball.position.set(0, 10, 0);
      basketball.name = 'basketball';
      basketball.castShadow = true; 
      scene.add(basketball);
    }

    addSphere(scene);


    let sphere = scene.getObjectByName('basketball');

    //Adding lighting
    const directionalLight = new THREE.DirectionalLight(0xffffff, 1); // Add directional light
    directionalLight.position.set(-10, 10, -10);
    directionalLight.castShadow = true;
    scene.add(directionalLight);

    const directionalLight2 = new THREE.DirectionalLight(0xffffff, 1); // Add directional light
    directionalLight2.position.set(0, 0, 30);
    directionalLight2.castShadow = true;
    scene.add(directionalLight2);

    const directionalLight3 = new THREE.DirectionalLight(0xffffff, 1); // Add directional light
    directionalLight3.position.set(0, 0, -30);
    directionalLight3.castShadow = true;
    scene.add(directionalLight3);

    const directionalLight4 = new THREE.DirectionalLight(0xffffff, 1); // Add directional light
    directionalLight4.position.set(0, 40, -30);
    directionalLight4.castShadow = true;
    scene.add(directionalLight4);

    //Lighting
    const pointLight = new THREE.PointLight(0xffffff, 2); // Intensity increased to 2
    pointLight.position.set(0, 0, 15); // Position the light
    pointLight.castShadow = true; // Enable shadows
    scene.add(pointLight);



      // camera
      camera = new THREE.PerspectiveCamera(30, 800/600, 0.1, 1000);
      camera.position.set(90,30, 100);
      camera.lookAt(scene.position);

      //Orbit Controls
      controls = new THREE.OrbitControls(camera, renderer.domElement);

      // Physics part

      //y-axis
      let acceleration = 9.8;
      let currentVelocity = 0;
      let currentHeight = sphere.position.y;

      //x-axis
      let currentXDistance = sphere.position.x;
      let currentXVelocity = 0;
      let currentXAcceleration = 2;

      function animate(){
        requestAnimationFrame(animate);

        // Time management
        const deltaTime = 0.016; 
        currentVelocity -= acceleration * deltaTime
        currentHeight = currentHeight + currentVelocity * deltaTime + 0.5 * acceleration * deltaTime * deltaTime;

        
  

        // Collision detection with the floor
        if (currentHeight <= 0) {
          currentHeight = 0; // Reset height to the floor level
          currentVelocity = -currentVelocity * 0.6;
        }

        currentXVelocity += currentXAcceleration * deltaTime;
        currentXDistance += currentXVelocity * deltaTime + 0.5 * currentXAcceleration * deltaTime * deltaTime;

        if (currentXDistance > 40){
          currentXVelocity = 0;
        }




        // Update the sphere's position
        sphere.position.y = currentHeight;
        sphere.position.x = currentXDistance;



        //currentXAcceleration *= 0.8

        // Render the scene
        renderer.setClearColor(0x7da7eb); // Set background color
        renderer.render(scene, camera);
      }

          // create an AudioListener and add it to the camera
      const listener = new THREE.AudioListener();
      camera.add( listener );

      // create a global audio source
      const sound = new THREE.Audio( listener );

      // load a sound and set it as the Audio object's buffer
      const audioLoader = new THREE.AudioLoader();
      audioLoader.load( '/Users/deepikadasari/Downloads/myAudio.mp3', function( buffer ) {
        sound.setBuffer( buffer );
        sound.setLoop( true );
        sound.setVolume( 0.5 );
        sound.play();
      });

    animate();
      
  }

</script>

  </body>
</html>